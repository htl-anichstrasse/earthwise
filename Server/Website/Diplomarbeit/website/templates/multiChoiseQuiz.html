{% extends "base.html" %}

{% block title %}Multi-Choice-Quiz{% endblock %}

{% block content %}

<style>
    .image-container {
        padding-left: 400px;
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: repeat(1, 1fr);
        gap: 40px;
        margin-bottom: 20px;
    }

    .multiChoiceButton {
        padding: 10px;
        font-size: 16px;
        background-color: #7f8c8d; /* Grau */
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        margin: 5px;
        width: 40%; /* Gleichbreite Buttons */
    }

    .selected {
        background-color: #2ecc71; /* Grün für ausgewählten Button */
    }
    .wrong {
        background-color:  #ff0000; /* Grün für ausgewählten Button */
    }

    .refreshButton {
        padding: 10px;
        font-size: 16px;
        background-color: #3498db; /* Blau für Refresh-Button */
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
</style>

{% set laender  = [land1, land2, land3, land4] %}
<h1 style="text-align: center"> {{quiz_name}} </h1>
<h3 style="text-align: center">{{discription}}</h3>

<div class="image-container">
    <div style="padding-top: 30px;">
        <img src="{{ url_for('static', filename= correctLand ) }}" width="300" height="180" style="border: 1px solid grey;">
    </div>
</div>

<div style="margin-bottom: 30px; text-align: center;"> 
    {% for i in laender %}
        {% set filename = i.split("/")[-1] %}
        {% set filename_without_extension = filename.split(".")[0] %}
        {% set filename_without_extension = filename_without_extension.replace('_', ' ')%}
        <button class="multiChoiceButton" onclick="checkAnswer('{{ filename_without_extension }}', this)">{{ filename_without_extension }}</button>
    {% endfor %}
</div>

<!-- Hinzugefügtes HTML-Element zur Anzeige der Anzahl der richtigen Antworten -->
<div id="correctAnswersCount" style="text-align: center; font-size: 18px;"></div>



<script>
    function checkAnswer(selectedAnswer, button) {
        // Überprüfe, ob der Button bereits ausgewählt wurde
        if (button.classList.contains('selected') || button.classList.contains('wrong')) {
            return;
        }
    
        var correctAnswer = "{{ correctLand }}";
        var correctAnswerFilename = correctAnswer.split('/').pop();
        var correctAnswerWithoutExtension = correctAnswerFilename.split(".")[0].replace('_', ' ');
    
        fetch(`/check_answer/${selectedAnswer}`, { method: 'POST', body: new URLSearchParams({ correct_answer: correctAnswerWithoutExtension }), headers: { 'Content-Type': 'application/x-www-form-urlencoded' } })
            .then(response => response.json())
            .then(data => {
                
                if (data.is_correct) {
                    button.classList.add('selected');
                    setTimeout(refreshPage, 3000);
                }
                if (!data.is_correct) {
                    button.classList.add('wrong');
                    setTimeout(refreshPage, 3000);
                }
    
                // Deaktiviere alle Buttons
                var buttons = document.querySelectorAll('.multiChoiceButton');
                buttons.forEach(btn => btn.disabled = true);
    
                // Anzeigen der Anzahl der richtigen Antworten statt eines Popups
                var correctAnswersCountElement = document.getElementById('correctAnswersCount');
                correctAnswersCountElement.innerHTML = `Anzahl der richtigen Antworten: ${data.correct_answers_count}`;
            })
            .catch(error => console.error('Error:', error));
    }
    
    
    

    // Funktion zum Neu laden der Seite
    function refreshPage() {
        location.reload();
    }
</script>

{% endblock %}
